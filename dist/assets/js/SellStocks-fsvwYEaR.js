import{r as e,j as t,m as s,R as a,i as l,X as i,Y as r,T as n,k as c,G as o,l as d,o as x,p as m,q as h,t as u,B as p,a as j,H as b,D as f,w as y,x as g,P as N,y as v}from"./index-CF6TildN.js";import{A as w}from"./AreaChart-D1EhQu4K.js";import"./react-BAR5trb5.js";import"./vendor-Cqa_4s5f.js";const k=({stock:s,onClose:a,onSuccess:l})=>{const[i,r]=e.useState(0),[n,c]=e.useState(null);return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-black rounded-xl p-8 w-96",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Sell ",s.symbol]}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Enter the quantity you want to sell (in rupees)."}),t.jsx("input",{type:"number",placeholder:"Quantity",value:i,onChange:e=>r(Number(e.target.value)),className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 mb-6 focus:outline-none focus:ring-2 focus:ring-white/20"}),n&&t.jsx("p",{className:"text-red-500 text-sm mb-4",children:n}),t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx("button",{onClick:a,className:"px-6 py-2 bg-white/10 rounded-xl hover:bg-white/20 transition-all",children:"Cancel"}),t.jsx("button",{onClick:()=>{i<=0?c("Quantity must be greater than 0."):i>s.quantity?c("Quantity exceeds available shares."):(c(null),l(s.symbol,i),a())},className:"px-6 py-2 bg-red-500 rounded-xl hover:bg-red-600 transition-all",children:"Sell"})]})]})})},S=(e,t=.005)=>e+e*t*(Math.random()-.5),F=({symbol:o,onTimeframeChange:d,basePrice:x=100})=>{const[m,h]=e.useState("1D"),[u,p]=e.useState([]),j={AAPL:150,MSFT:380,GOOGL:140,TSLA:250,NVDA:800}[o]||x;e.useEffect((()=>{const e=((e,t=100)=>{const s=[],a={"1D":24,"1W":168,"1M":30,"3M":90,"1Y":252,"5Y":1260}[e]||24;let l=t;const i=new Date;for(let r=0;r<a;r++){const t=new Date(i);"1D"===e||"1W"===e?t.setHours(t.getHours()-r):t.setDate(t.getDate()-r),l=S(l),s.unshift({date:t.toISOString(),price:Number(l.toFixed(2))})}return s})(m,j);p(e)}),[m,j]);const b=u.length>0?u[u.length-1].price-u[0].price:0,f=u.length>0?(b/u[0].price*100).toFixed(2):"0.00";return t.jsxs(s.div,{initial:{opacity:0,y:0},animate:{opacity:1,y:0},className:"relative h-[400px] bg-black/40 backdrop-blur-xl rounded-2xl p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-medium text-white",children:o}),t.jsxs("div",{className:"text-sm "+(b>=0?"text-green-400":"text-red-400"),children:[b>=0?"+":"",f,"%"]})]}),t.jsx("div",{className:"flex gap-2",children:["1D","1W","1M","3M","1Y","5Y"].map((e=>t.jsx("button",{onClick:()=>(e=>{h(e),null==d||d(e)})(e),className:"px-3 py-1 rounded-full text-sm transition-all "+(m===e?"bg-white/10 text-white":"text-white/60 hover:text-white"),children:e},e)))})]}),t.jsx(a,{width:"100%",height:"100%",children:t.jsxs(w,{data:u,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#60A5FA",stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:"#60A5FA",stopOpacity:0})]})}),t.jsx(l,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)",vertical:!1}),t.jsx(i,{dataKey:"date",tickFormatter:e=>{const t=new Date(e);return"1D"===m?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{day:"numeric",month:"short"})},stroke:"rgba(255,255,255,0.5)",tick:{fill:"rgba(255,255,255,0.5)",fontSize:12}}),t.jsx(r,{domain:["auto","auto"],stroke:"rgba(255,255,255,0.5)",tick:{fill:"rgba(255,255,255,0.5)",fontSize:12},tickFormatter:e=>`$${e}`}),t.jsx(n,{contentStyle:{backgroundColor:"rgba(0,0,0,0.9)",border:"none",backdropFilter:"blur(10px)",padding:"12px",borderRadius:"8px"},labelFormatter:e=>new Date(e).toLocaleString()}),t.jsx(c,{type:"monotone",dataKey:"price",stroke:"#60A5FA",fill:"url(#colorPrice)",strokeWidth:2})]})})]},o)},C=({stock:a,onSellClick:l,loading:i})=>{var r;const[n,c]=e.useState("1D"),[j,b]=e.useState(new Date),[f,y]=e.useState([]),[g,N]=e.useState(!1);if(e.useEffect((()=>{const e=setInterval((()=>{b(new Date)}),1e3);return()=>clearInterval(e)}),[]),i||!a)return t.jsx("div",{className:"h-full flex items-center justify-center text-white/60",children:t.jsxs("div",{className:"text-center",children:[t.jsx(o,{size:48,className:"mx-auto mb-4 opacity-60"}),t.jsx("p",{className:"text-xl",children:"Select a stock to view details"})]})});const v="#16a34a",w="#4ade80",k="#facc15",S="#f87171",C="#dc2626";return t.jsx(d,{mode:"wait",children:t.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-full bg-black/40 backdrop-blur-xl p-4 lg:p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-semibold text-white",children:a.name}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-white/60",children:a.symbol}),t.jsx("span",{className:"text-white/60",children:"•"}),t.jsx("span",{className:"text-white/60",children:j.toLocaleTimeString()})]})]})}),t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsxs("span",{className:"text-4xl font-medium",children:["$",(null==(r=a.currentPrice)?void 0:r.toFixed(2))||"N/A"]}),t.jsxs(s.span,{animate:{color:(a.totalReturn||0)>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)"},className:"flex items-center text-lg",children:[(a.totalReturn||0)>=0?t.jsx(x,{size:20}):t.jsx(m,{size:20}),Math.abs(a.totalReturn||0).toFixed(2),"%"]})]}),t.jsx("div",{className:"flex gap-1 mb-4 overflow-x-auto scrollbar-hide",children:["1D","1W","1M","3M","1Y","ALL"].map((e=>t.jsx("button",{onClick:()=>c(e),className:"px-3 py-1 rounded-full text-xs font-medium transition-all whitespace-nowrap "+(n===e?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"),children:e},e)))}),t.jsx("div",{className:"flex-1 bg-black/20 rounded-xl p-4 backdrop-blur-sm mb-4",children:t.jsx("div",{className:"h-full",children:t.jsx(F,{stock:a,timeFrame:n})})}),t.jsx("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[{icon:t.jsx(h,{size:16}),label:"Volume",value:(a.volume||0).toLocaleString()},{icon:t.jsx(u,{size:16}),label:"High",value:`₹${(a.high||0).toFixed(2)}`},{icon:t.jsx(p,{size:16}),label:"Low",value:`₹${(a.low||0).toFixed(2)}`}].map(((e,s)=>t.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-1 text-white/60 mb-1 text-xs",children:[e.icon,t.jsx("span",{className:"font-medium",children:e.label})]}),t.jsx("p",{className:"text-lg font-medium truncate",children:e.value})]},s)))}),t.jsxs("div",{className:"bg-black/20 rounded-xl p-4 backdrop-blur-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recommendation Trends"}),g?t.jsx("div",{className:"flex justify-center items-center py-4",children:t.jsx("span",{className:"text-white/60",children:"Loading trends..."})}):f.length>0?t.jsx("div",{className:"space-y-4",children:f.map(((e,s)=>t.jsxs("div",{className:"bg-white/5 rounded-xl p-3",children:[t.jsxs("p",{className:"text-sm text-white/60 mb-2",children:["Period: ",e.period]}),t.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-xs text-white/60",children:"Strong Buy"}),t.jsx("p",{className:"text-lg font-medium",style:{color:v},children:e.strongBuy})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-xs text-white/60",children:"Buy"}),t.jsx("p",{className:"text-lg font-medium",style:{color:w},children:e.buy})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-xs text-white/60",children:"Hold"}),t.jsx("p",{className:"text-lg font-medium",style:{color:k},children:e.hold})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-xs text-white/60",children:"Sell"}),t.jsx("p",{className:"text-lg font-medium",style:{color:S},children:e.sell})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-xs text-white/60",children:"Strong Sell"}),t.jsx("p",{className:"text-lg font-medium",style:{color:C},children:e.strongSell})]})]})]},s)))}):t.jsx("div",{className:"flex justify-center items-center py-4",children:t.jsx("span",{className:"text-white/60",children:"No recommendation trends available."})})]})]})})},D=e=>new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}).format(e/100),A=()=>{const[a,l]=e.useState(!0),[i,r]=e.useState(null),[n,c]=e.useState(""),[h,u]=e.useState(null),[p,w]=e.useState(null),[S,F]=e.useState(!1),[A,z]=e.useState([]),{user:L,token:T}=j();e.useEffect((()=>{(async()=>{try{const e=await fetch("https://production-backend-final.onrender.com/portfolio",{method:"GET",headers:{Authorization:`Bearer ${T}`}});if(!e.ok)throw new Error("Failed to fetch portfolio");const{data:t}=await e.json();if(console.log("Backend Response:",t),!Array.isArray(t))throw new Error("Invalid portfolio data format");{const e=t.filter((e=>(null==e?void 0:e.symbol)&&(null==e?void 0:e.name)));z(e)}}catch(e){console.error("Error fetching portfolio:",e),r("Failed to load portfolio"),z([])}finally{l(!1)}})()}),[T]);const P=(Array.isArray(A)?A:[]).filter((e=>{var t,s;return(null==(t=null==e?void 0:e.symbol)?void 0:t.toLowerCase().includes(n.toLowerCase()))||(null==(s=null==e?void 0:e.name)?void 0:s.toLowerCase().includes(n.toLowerCase()))}));return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-zinc-900 to-black text-white",children:[t.jsx(b,{}),t.jsx("div",{children:t.jsx("div",{className:"mt-32 absolute flex z-20 px-8 justify-end w-full",children:p&&t.jsxs("button",{onClick:()=>u(p),className:"px-8 py-3 bg-white text-black font-medium rounded-full hover:bg-white/90 transition-all flex items-center gap-2",children:[t.jsx(f,{size:20}),"Sell ",p.symbol]})})}),t.jsxs("div",{className:"flex h-screen pt-20",children:[t.jsx("div",{className:"w-98 bg-black/30 border-r border-white/10 overflow-hidden",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"relative mb-6",children:[t.jsx(y,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white/40",size:20}),t.jsx("input",{type:"text",placeholder:"Search stocks...",value:n,onChange:e=>c(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-2xl pl-12 pr-4 py-3 text-base focus:outline-none focus:ring-2 focus:ring-white/20"})]}),t.jsx("div",{className:"space-y-4 overflow-y-auto w-[400px] h-[calc(100vh-200px)]",children:a?t.jsx(g,{}):P.map((e=>{return t.jsx(s.div,{layout:!0,className:"p-4 rounded-xl cursor-pointer transition-all "+((null==p?void 0:p.symbol)===e.symbol?"bg-white/10":"bg-black/20 hover:bg-white/5"),onClick:()=>{w(e)},children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium",children:e.symbol}),t.jsx("p",{className:"text-sm text-white/60",children:e.name})]}),t.jsxs(s.div,{animate:{color:(e.totalReturn||0)>=0?"#34D399":"#EF4444"},className:"text-right",children:[t.jsx("p",{className:"font-medium",children:(a=e.currentPrice,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a))}),t.jsx("p",{className:"text-sm flex items-center gap-1",children:void 0!==e.totalReturn&&t.jsxs(t.Fragment,{children:[e.totalReturn>=0?t.jsx(x,{size:12}):t.jsx(m,{size:12}),D(Math.abs(e.totalReturn))]})})]})]})},e.symbol);var a}))})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:p?t.jsx(C,{stock:p,onSellClick:u,loading:a}):t.jsx("div",{className:"h-full flex items-center justify-center text-white/60",children:t.jsxs("div",{className:"text-center",children:[t.jsx(o,{size:48,className:"mx-auto mb-4 opacity-60"}),t.jsx("p",{className:"text-xl",children:"Select a stock to view details"})]})})})]}),t.jsxs("div",{className:"p-8",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Your Portfolio"}),t.jsx(N,{data:A})]}),t.jsx(d,{children:S&&t.jsx(s.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed bottom-8 right-8 z-50",children:t.jsxs("div",{className:"bg-green-500 text-white px-6 py-4 rounded-xl shadow-xl flex items-center gap-3",children:[t.jsx("div",{className:"bg-white/20 rounded-full p-1",children:t.jsx(v,{className:"w-4 h-4"})}),t.jsx("span",{children:"Transaction completed successfully!"})]})})}),h&&t.jsx(k,{stock:h,onClose:()=>u(null),onSuccess:async(e,t)=>{try{const s=await fetch("https://production-backend-final.onrender.com/transaction/sell",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`},body:JSON.stringify({stockSymbol:e,quantity:t,price:(null==p?void 0:p.currentPrice)||0})});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to process transaction")}z((s=>s.map((s=>{if(s.symbol===e){const e=s.quantity-t;return{...s,quantity:e}}return s})).filter((e=>e.quantity>0)))),F(!0),setTimeout((()=>{F(!1)}),3e3)}catch(s){console.error("Sell transaction failed:",s),r("Failed to sell stock")}}})]})};export{A as SellStocks,A as default};
//# sourceMappingURL=SellStocks-fsvwYEaR.js.map
