import{r as e,a as t,j as s,X as a,A as r,m as l,R as i,i as c,k as n,Y as o,T as d,l as x,o as m,p as h,G as u,q as g,t as p,v as y,w as f,H as b,D as j,x as N,y as w,z as v,F as k}from"./index-DPGmTnef.js";import{M as S,P as C,A as F,e as P,F as D}from"./index.esm-BkbFAReg.js";import"./react-BAR5trb5.js";import"./vendor-Cqa_4s5f.js";const I=({stock:l,onClose:i,onSuccess:c})=>{var n;const[o,d]=e.useState(1),{isAuthenticated:x}=t(),[m,h]=e.useState(!1),{isProcessing:u,error:g,handlePurchase:p}=function({onSuccess:s}){const[a,r]=e.useState(!1),[l,i]=e.useState(null),{token:c,user:n,isAuthenticated:o}=t();return{isProcessing:a,error:l,handlePurchase:async(e,t)=>{if(o&&c)if(!e||t<=0)i("Invalid stock or quantity.");else{r(!0),i(null);try{const a=await fetch("https://production-backend-final.onrender.com/transaction/buy",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({stockSymbol:e.symbol,stockName:e.name,quantity:t,price:e.price,change:e.change||0,percentChange:e.percentChange||0,high:e.high||e.price,low:e.low||e.price,openPrice:e.openPrice||e.price,previousClose:e.previousClose||e.price,userId:null==n?void 0:n.email})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Transaction failed. Please try again.")}s()}catch(a){i(a instanceof Error?a.message:"An unexpected error occurred.")}finally{r(!1)}}else i("Please log in to continue.")}}}({onSuccess:()=>{if(!l)return;const e=l.price*o;c(o,e),i()}});return l?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-xl z-50 flex items-center justify-center",children:s.jsxs("div",{className:"bg-[#111111] backdrop-blur-xl rounded-2xl p-8 w-full max-w-md mx-4 border border-white/10",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-medium text-white",children:l.name}),s.jsx("p",{className:"text-white/60 text-sm",children:l.symbol})]}),s.jsx("button",{onClick:i,className:"text-white/60 hover:text-white transition-colors p-2 rounded-full hover:bg-white/5",children:s.jsx(a,{size:24})})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("span",{className:"text-sm text-white/60",children:"Quantity"}),s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsx("button",{onClick:()=>d(Math.max(1,o-1)),className:"w-12 h-12 rounded-full bg-white/5 hover:bg-white/10 flex items-center justify-center text-white border border-white/10 transition-all",children:s.jsx(S,{size:20})}),s.jsx("span",{className:"text-4xl font-light text-white w-16 text-center",children:o}),s.jsx("button",{onClick:()=>d(o+1),className:"w-12 h-12 rounded-full bg-white/5 hover:bg-white/10 flex items-center justify-center text-white border border-white/10 transition-all",children:s.jsx(C,{size:20})})]})]}),s.jsxs("div",{className:"space-y-4 border-t border-white/10 pt-6",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-white/60",children:"Price per share"}),s.jsxs("span",{className:"text-white font-medium",children:["₹",null==(n=l.price)?void 0:n.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-xl",children:[s.jsx("span",{className:"text-white/80",children:"Total Amount"}),s.jsxs("span",{className:"text-white font-medium",children:["₹",(l.price*o).toFixed(2)]})]})]}),g&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 text-red-400 text-sm",children:g}),s.jsxs("div",{className:"space-y-3 pt-4",children:[s.jsx("button",{onClick:async()=>{x?l&&await p(l,o):h(!0)},disabled:u,className:"w-full py-4 bg-white text-black rounded-full font-medium hover:bg-white/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm uppercase tracking-wide",children:u?"Processing...":"Buy Now"}),s.jsx("button",{onClick:i,className:"w-full py-4 text-white/60 font-medium hover:text-white transition-colors text-sm uppercase tracking-wide",children:"Cancel"})]})]})]})}),s.jsx(r,{isOpen:m,onClose:()=>h(!1),onSuccess:()=>{h(!1),l&&p(l,o)}})]}):null},$=(e,t=100)=>{const s=[],a={"1D":78,"1W":168,"1M":30,"3M":90,"1Y":252,ALL:1260}[e]||78,r=((e,t,s=.002)=>{let a=[e];for(let r=1;r<t;r++){const t=a[r-1]*s*(Math.random()-.5)*.5+.3*(a[r-1]-(r>1?a[r-2]:e));a.push(a[r-1]+t)}return a})(t,a),l=new Date;for(let i=0;i<a;i++){const t=new Date(l);"1D"===e?t.setMinutes(t.getMinutes()-5*i):"1W"===e?t.setHours(t.getHours()-i):t.setDate(t.getDate()-i),s.unshift({date:t.toISOString(),price:Number(r[i].toFixed(2))})}return s},_=({stock:t,timeFrame:a,currentPrice:r,change:u,onTimeframeChange:g})=>{const[p,y]=e.useState([]),[f,b]=e.useState(!0),j=e.useCallback((async()=>{const e=`historical_${t.symbol}_${a}`,s=localStorage.getItem(e),l=localStorage.getItem(`${e}_timestamp`),i=Date.now();if(s&&l&&i-Number(l)<18e5)return y(JSON.parse(s)),void b(!1);b(!0);try{const t=$(a,r);localStorage.setItem(e,JSON.stringify(t)),localStorage.setItem(`${e}_timestamp`,i.toString()),y(t)}catch(c){console.error("Failed to fetch historical data:",c)}finally{b(!1)}}),[t.symbol,a,r]);e.useEffect((()=>{j()}),[j]);const N=e.useCallback((()=>{if(0===p.length||"1D"!==a)return;const e=p[p.length-1].price,s=t.changePercent/100,r=1e-4*e*(Math.random()-.5+.3*s),l=Number((e+r).toFixed(2)),i={date:(new Date).toISOString(),price:l};y((e=>[...e.slice(1),i]))}),[p,t.changePercent,a]);e.useEffect((()=>{if(f||"1D"!==a)return;const e=setInterval((()=>{N()}),5e3+2e3*Math.random());return()=>clearInterval(e)}),[f,N,a]);const w=p.length>0?p[p.length-1].price-p[0].price:0,v=({active:e,payload:r,label:l})=>{if(e&&r&&r.length){const e=new Date(l),i=r[0].value;return s.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-gray-200 rounded-lg p-4 shadow-xl",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"1D"===a?e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString([],{month:"short",day:"numeric"})}),s.jsxs("p",{className:"text-black text-lg font-medium",children:["₹",i.toFixed(2)," "]}),s.jsx("p",{className:"text-xs flex items-center gap-1",children:void 0!==t.change&&s.jsxs(s.Fragment,{children:[t.change>=0?s.jsx(m,{size:10}):s.jsx(h,{size:10}),Math.abs(t.change).toFixed(2),"%"]})})]})}return null},k=p.length>0?p[p.length-1].price:r;return s.jsxs("div",{className:"h-full relative bg-white",children:[f?s.jsx("div",{className:"h-full flex items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx(l.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-2 border-gray-200 border-t-gray-400 rounded-full"}),s.jsx("span",{className:"text-gray-400 text-sm font-medium",children:"Loading chart..."})]})}):s.jsx(i,{width:"95%",height:"100%",children:s.jsxs(F,{data:p,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:w>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",stopOpacity:.2}),s.jsx("stop",{offset:"99%",stopColor:w>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",stopOpacity:0})]})}),s.jsx(c,{strokeDasharray:"3 3",stroke:"rgba(0,0,0,0.05)",vertical:!1}),s.jsx(n,{dataKey:"date",tickFormatter:e=>{const t=new Date(e);return"1D"===a?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{day:"numeric",month:"short"})},stroke:"rgba(0,0,0,0.1)",tick:{fill:"rgba(0,0,0,0.6)",fontSize:11},axisLine:{stroke:"rgba(0,0,0,0.1)"},tickLine:{stroke:"rgba(0,0,0,0.1)"}}),s.jsx(o,{domain:["auto","auto"],stroke:"rgba(0,0,0,0.1)",tick:{fill:"rgba(0,0,0,0.6)",fontSize:11},tickFormatter:e=>`₹${e.toFixed(2)}`,axisLine:{stroke:"rgba(0,0,0,0.1)"},tickLine:{stroke:"rgba(0,0,0,0.1)"},tickCount:6,width:65}),s.jsx(d,{content:s.jsx(v,{}),cursor:{stroke:"rgba(0,0,0,0.1)",strokeWidth:1,strokeDasharray:"4 4"}}),s.jsx(x,{type:"monotone",dataKey:"price",stroke:w>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",strokeWidth:1.5,fill:"url(#colorPrice)",animationDuration:750,dot:!1,activeDot:{r:4,fill:w>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)",stroke:"#fff",strokeWidth:1}})]})}),s.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"absolute top-4 right-4 bg-white/90 backdrop-blur-xl border border-gray-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-gray-600 text-sm",children:"Current Price"}),s.jsxs("p",{className:"text-black text-2xl font-medium",children:["₹",k.toFixed(2)," "]})]})]})},z="ctksb2pr01qn6d7jeekgctksb2pr01qn6d7jeel0",E="https://finnhub.io/api/v1",T=18e5,L={async getQuote(e){const t=`quote_${e}`,s=localStorage.getItem(t),a=localStorage.getItem(`${t}_timestamp`),r=Date.now();if(s&&a&&r-Number(a)<T)return JSON.parse(s);const l=await fetch(`${E}/quote?symbol=${e}&token=${z}`);if(!l.ok)throw new Error("Failed to fetch quote");const i=await l.json();return localStorage.setItem(t,JSON.stringify(i)),localStorage.setItem(`${t}_timestamp`,r.toString()),i},async getRecommendationTrends(e){const t=`recommendation_${e}`,s=localStorage.getItem(t),a=localStorage.getItem(`${t}_timestamp`),r=Date.now();if(s&&a&&r-Number(a)<T)return JSON.parse(s);const l=await fetch(`${E}/stock/recommendation?symbol=${e}&token=${z}`);if(!l.ok)throw new Error("Failed to fetch recommendation trends");const i=await l.json();return localStorage.setItem(t,JSON.stringify(i)),localStorage.setItem(`${t}_timestamp`,r.toString()),i}},O=({stock:t,onBuyClick:r,loading:i})=>{var c;const[n,o]=e.useState("1D"),[d,x]=e.useState(new Date),[p,y]=e.useState([]),[f,b]=e.useState(!1),[j,N]=e.useState(!1);if(e.useEffect((()=>{(async()=>{if(!(null==t?void 0:t.symbol))return;const s=`recommendation_${t.symbol}`,a=localStorage.getItem(s),r=localStorage.getItem(`${s}_timestamp`),l=Date.now();if(a&&r&&l-Number(r)<18e5)y(JSON.parse(a));else{e.startTransition((()=>{b(!0)}));try{const a=await L.getRecommendationTrends(t.symbol);localStorage.setItem(s,JSON.stringify(a)),localStorage.setItem(`${s}_timestamp`,l.toString()),e.startTransition((()=>{y(a)}))}catch(i){console.error("Failed to fetch recommendation trends:",i)}finally{e.startTransition((()=>{b(!1)}))}}})()}),[null==t?void 0:t.symbol]),e.useEffect((()=>{const e=setInterval((()=>{x(new Date)}),1e3);return()=>clearInterval(e)}),[]),i||!t)return s.jsx("div",{className:"flex items-center justify-center h-full text-gray-600",children:s.jsxs("div",{className:"text-center",children:[s.jsx(u,{size:48,className:"mx-auto mb-4 opacity-60"}),s.jsx("p",{className:"text-xl",children:"Select a stock to view details"})]})});const w=()=>{N(!1)};return s.jsx(g,{mode:"wait",children:s.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex -mt-6 flex-col h-full bg-white backdrop-blur-xl p-4 lg:p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-black",children:t.name}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"text-gray-600",children:t.symbol}),s.jsx("span",{className:"text-gray-600",children:"•"}),s.jsx("span",{className:"text-gray-600",children:d.toLocaleTimeString()})]})]})}),s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsxs("span",{className:"text-4xl font-medium text-black",children:["₹",(null==(c=t.price)?void 0:c.toFixed(2))??"N/A"," "]}),s.jsxs(l.span,{animate:{color:(t.change||0)>=0?"rgb(34, 197, 94)":"rgb(239, 68, 68)"},className:"flex items-center text-lg",children:[(t.change||0)>=0?s.jsx(m,{size:20}):s.jsx(h,{size:20}),Math.abs(t.change||0).toFixed(2),"%"]})]}),s.jsx("div",{className:"flex gap-1 mb-4 overflow-x-auto scrollbar-hide",children:["1D","1W","1M","3M","1Y","ALL"].map((e=>s.jsx("button",{onClick:()=>o(e),className:"px-3 py-1 rounded-full text-xs font-medium transition-all whitespace-nowrap "+(n===e?"bg-black text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e)))}),s.jsx("div",{className:"flex-1 bg-gray-100 rounded-xl mt-16 backdrop-blur-sm",children:s.jsx("div",{className:"h-full",children:s.jsx(_,{stock:t,timeFrame:n,currentPrice:t.price,change:t.change})})}),s.jsxs("div",{className:"rounded-xl p-4 backdrop-blur-sm cursor-pointer",onClick:()=>{N(!0)},children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recommendation Trends"}),f?s.jsx("div",{className:"flex justify-center items-center py-4",children:s.jsx("span",{className:"text-gray-600",children:"Loading trends..."})}):p.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full bg-white rounded-xl shadow-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-left",children:"Period"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Strong Buy"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Buy"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Hold"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Sell"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Strong Sell"})]})}),s.jsx("tbody",{children:p.slice(0,1).map(((e,t)=>s.jsxs("tr",{className:"border-t border-gray-200",children:[s.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.period}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#4CAF50"},children:[" ",e.strongBuy]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#8BC34A"},children:[" ",e.buy]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#FFC107"},children:[" ",e.hold]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#FF5722"},children:[" ",e.sell]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#F44336"},children:[" ",e.strongSell]})]},t)))})]})}):s.jsx("div",{className:"flex justify-center items-center py-4",children:s.jsx("span",{className:"text-gray-600",children:"No recommendation trends available."})})]}),s.jsx(g,{children:j&&s.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-5 flex items-center justify-center p-4 z-50",onClick:w,children:s.jsxs(l.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:-20},className:"bg-white rounded-xl w-full max-w-2xl p-6 relative",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{onClick:w,className:"absolute top-4 right-4 p-2 text-gray-600 hover:text-gray-800",children:s.jsx(a,{size:20})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recommendation Trends"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full bg-white rounded-xl shadow-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-left",children:"Period"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Strong Buy"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Buy"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Hold"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Sell"}),s.jsx("th",{className:"px-4 py-2 text-xs text-gray-600 text-center",children:"Strong Sell"})]})}),s.jsx("tbody",{children:p.map(((e,t)=>s.jsxs("tr",{className:"border-t border-gray-200",children:[s.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.period}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#4CAF50"},children:[" ",e.strongBuy]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#8BC34A"},children:[" ",e.buy]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#FFC107"},children:[" ",e.hold]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#FF5722"},children:[" ",e.sell]}),s.jsxs("td",{className:"px-4 py-3 text-lg font-medium text-center",style:{color:"#F44336"},children:[" ",e.strongSell]})]},t)))})]})})]})})})]})})},A=18e5;class B extends p.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Error caught by ErrorBoundary:",e,t)}render(){return this.state.hasError?s.jsx("h1",{children:"Something went wrong. Please try again later."}):this.props.children}}const M=()=>{const{user:a}=t(),[r,i]=e.useState(y),[c,n]=e.useState(!0),[o,d]=e.useState(null),[x,p]=e.useState(""),[S,C]=e.useState(null),[F,$]=e.useState(null),[_,z]=e.useState(!1),[E,T]=e.useState(!1),[M,J]=e.useState(!1),[q,W]=e.useState((null==a?void 0:a.email)||""),H=f(),R=((t,s)=>{const[a,r]=e.useState(t);return e.useEffect((()=>{const e=setTimeout((()=>{r(t)}),s);return()=>{clearTimeout(e)}}),[t,s]),a})(x,300);e.useEffect((()=>{(async()=>{n(!0);try{const e=await(async()=>await Promise.all(y.map((async e=>{const t=`stockData_${e.symbol}`,s=localStorage.getItem(t),a=localStorage.getItem(`${t}_timestamp`),r=Date.now();if(s&&a&&r-Number(a)<A)return JSON.parse(s);try{const s=await L.getQuote(e.symbol),a={...e,price:s.c||0,change:s.d||0,changePercent:s.dp||0,highPrice:s.h||0,lowPrice:s.l||0,openPrice:s.o||0,previousClose:s.pc||0};return localStorage.setItem(t,JSON.stringify(a)),localStorage.setItem(`${t}_timestamp`,r.toString()),a}catch(o){return console.error(`Failed to fetch data for ${e.symbol}:`,o),{...e,price:0,change:0,changePercent:0,highPrice:0,lowPrice:0,openPrice:0,previousClose:0}}}))))();i(e)}catch(e){console.error("Failed to fetch stock data:",e),d("Failed to fetch stock data")}finally{n(!1)}})()}),[]),e.useEffect((()=>{a&&W(a.email||"")}),[a]),e.useEffect((()=>{var e;(null==(e=H.state)?void 0:e.selectedStock)&&(C(H.state.selectedStock),$(H.state.selectedStock))}),[H.state]),e.useEffect((()=>{try{P.init("eyK87ZsxW822cQvyN")}catch(e){console.error("Failed to initialize EmailJS:",e)}}),[]),e.useEffect((()=>{(async()=>{n(!0);try{const e=await Promise.all(y.map((async e=>{const t=localStorage.getItem(`stockData_${e.symbol}`),s=localStorage.getItem(`cacheTimestamp_${e.symbol}`),a=Date.now();if(t&&s&&a-Number(s)<A)return JSON.parse(t);try{const t=await fetch(`https://finnhub.io/api/v1/quote?symbol=${e.symbol}&token=${API_KEY}`);if(!t.ok)throw new Error(`Failed to fetch data for ${e.symbol}`);const s=await t.json(),r={...e,price:s.c||0,change:s.d||0,changePercent:s.dp||0,highPrice:s.h||0,lowPrice:s.l||0,openPrice:s.o||0,previousClose:s.pc||0};return localStorage.setItem(`stockData_${e.symbol}`,JSON.stringify(r)),localStorage.setItem(`cacheTimestamp_${e.symbol}`,a.toString()),r}catch(r){return console.error(`Failed to fetch data for ${e.symbol}:`,r),{...e,price:0,change:0,changePercent:0,highPrice:0,lowPrice:0,openPrice:0,previousClose:0}}})));i(e)}catch(e){console.error("Failed to fetch stock data:",e),d("Failed to fetch stock data")}finally{n(!1)}})()}),[]);const K=e.useMemo((()=>r.filter((e=>e.symbol.toLowerCase().includes(R.toLowerCase())||e.name.toLowerCase().includes(R.toLowerCase())))),[R,r]);return s.jsxs(B,{children:[s.jsxs("div",{className:"min-h-screen w-full text-black",children:[s.jsx(b,{}),s.jsx("div",{children:s.jsx("div",{className:"mt-28 absolute flex z-20 px-8 justify-end w-full",children:F&&s.jsxs("button",{onClick:()=>J(!0),className:"px-8 py-3 bg-black text-white font-medium rounded-full hover:bg-black/90 transition-all flex items-center gap-2",children:[s.jsx(j,{size:16}),"Buy ",F.symbol]})})}),s.jsxs("div",{className:"flex h-screen pt-20",children:[s.jsx("div",{className:"w-98 bg-white border-r border-gray-200 overflow-hidden",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx(N,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),s.jsx("input",{type:"text",placeholder:"Search stocks...",value:x,onChange:e=>p(e.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-2xl pl-10 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-300"})]}),s.jsx("div",{className:"space-y-4 overflow-y-auto w-[400px] hide-scrollbar",children:c?s.jsx(w,{}):s.jsx(D,{height:600,itemCount:K.length,itemSize:80,width:400,children:({index:e,style:t})=>{const a=K[e],r=(null==F?void 0:F.symbol)===a.symbol;return 0===a.price?s.jsx(l.div,{style:{...t,marginBottom:"16px"},className:"p-4 w-98 bg-white hover:bg-gray-50 transition-colors duration-200 cursor-pointer",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded mb-2 animate-pulse"}),s.jsx("div",{className:"h-3 w-32 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded mb-2 animate-pulse"}),s.jsx("div",{className:"h-3 w-12 bg-gray-200 rounded animate-pulse"})]})]})}):s.jsx(l.div,{style:{...t,marginBottom:"16px"},layout:!0,className:`p-4 w-98 ${r?"bg-gray-200 rounded":"bg-white hover:bg-gray-50"} transition-colors duration-200 cursor-pointer`,onClick:()=>(async e=>{z(!0),$(e);try{const t={...e};$(t)}catch(t){console.error("Failed to load stock details:",t),d("Failed to load stock details")}finally{z(!1)}})(a),children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-sm text-black",children:a.symbol}),s.jsx("p",{className:"text-xs text-gray-600",children:a.name})]}),s.jsxs(l.div,{animate:{color:(a.change||0)>=0?"#16a34a":"#dc2626"},className:"text-right",children:[s.jsxs("p",{className:"font-medium text-sm text-black",children:["₹",(a.price||0).toFixed(2)]}),s.jsx("p",{className:"text-xs flex items-center gap-1",children:void 0!==a.change&&s.jsxs(s.Fragment,{children:[a.change>=0?s.jsx(m,{size:10}):s.jsx(h,{size:10}),Math.abs(a.change).toFixed(2),"%"]})})]})]})})}})})]})}),s.jsx("div",{className:"flex-1 ",children:_?s.jsx(w,{}):F?s.jsx(O,{stock:F,onBuyClick:C,loading:c}):s.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-b from-gray-50 to-white",children:s.jsxs("div",{className:"text-center max-w-md px-4",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-black rounded-2xl shadow-lg mb-6",children:s.jsx(u,{size:28,className:"text-white"})}),s.jsx("p",{className:"text-lg text-gray-600 mb-6",children:"Select a stock to view details."}),s.jsx("p",{className:"text-sm text-gray-500 mt-6",children:"Dive into real-time data, charts, and insights to make informed decisions."})]})})})]}),s.jsx(g,{children:E&&s.jsxs(l.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed inset-0 flex items-center justify-center z-50",children:[s.jsx("div",{className:"bg-black/50 backdrop-blur-sm fixed inset-0"}),s.jsx(l.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-white/90 backdrop-blur-lg rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 border border-gray-200",children:s.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[s.jsx("div",{className:"bg-green-500/10 rounded-full p-3",children:s.jsx(v,{className:"w-6 h-6 text-green-500"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Success!"}),s.jsx("p",{className:"text-gray-600",children:"Transaction completed successfully! A notification has been sent to your email."}),s.jsx("button",{onClick:()=>T(!1),className:"mt-4 px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Close"})]})})]})}),s.jsx(g,{children:M&&F&&s.jsx(I,{stock:F,onClose:()=>J(!1),onSuccess:(t,s)=>(async(t,s,r)=>{if("number"!=typeof r||isNaN(r))console.error("Invalid totalPrice:",r);else if(e.startTransition((()=>{T(!0)})),setTimeout((()=>{e.startTransition((()=>{T(!1)}))}),3e3),null==a?void 0:a.email)try{const e={to_email:a.email,stock_symbol:t.symbol,stock_name:t.name,quantity:s,total_price:r.toFixed(2)};await P.send("service_box535f","template_l4fugpk",e),console.log("Email notification sent successfully!")}catch(l){console.error("Failed to send email notification:",l)}else console.error("User email not found."),alert("User email not found. Please update your email in settings.")})(F,t,s)})})]}),s.jsx(k,{})]})};export{M as BuyStocks,M as default};
//# sourceMappingURL=BuyStocks-Cbux43yz.js.map
